<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPC Diagnostic Terminal | Sir Fransisco</title>
    <style>
        :root {
            --clinic-blue: #0a84ff;
            --sterile-white: #f5f7fa;
            --bio-hazard: #ff3b30;
            --lab-green: #34c759;
            --deep-slate: #1c1c1e;
        }

        body {
            background: radial-gradient(circle at center, #1a2a3a 0%, #000 100%);
            color: var(--sterile-white);
            font-family: 'Segoe UI', system-ui, sans-serif;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .lab-terminal {
            width: 95%;
            max-width: 750px;
            background: rgba(28, 28, 30, 0.98);
            border: 1px solid #3a3a3c;
            border-top: 6px solid var(--clinic-blue);
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 50px 100px rgba(0,0,0,0.9);
            margin: 20px;
            position: relative;
        }

        .header { border-bottom: 1px solid #3a3a3c; padding-bottom: 15px; margin-bottom: 25px; display: flex; justify-content: space-between; align-items: center;}
        h2 { font-weight: 300; letter-spacing: 2px; text-transform: uppercase; margin: 0; font-size: 1.2rem;}

        .input-field { width: 100%; background: #000; border: 1px solid #3a3a3c; padding: 12px; color: var(--lab-green); font-family: monospace; margin-bottom: 15px; outline: none; border-radius: 4px;}
        
        .action-btn { width: 100%; padding: 18px; background: var(--clinic-blue); color: white; border: none; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; cursor: pointer; border-radius: 4px; transition: 0.3s; }
        .action-btn:hover { background: #0071db; transform: translateY(-2px); }

        .option-card { background: rgba(255,255,255,0.03); border: 1px solid #3a3a3c; padding: 16px; margin: 10px 0; cursor: pointer; transition: 0.2s; font-size: 14px; border-radius: 6px; }
        .option-card:hover { border-color: var(--clinic-blue); background: rgba(10, 132, 255, 0.05); }
        .option-card.active { border-color: var(--clinic-blue); border-left: 10px solid var(--clinic-blue); background: rgba(10, 132, 255, 0.1); }

        /* Review Section */
        #reviewSection { margin-top: 30px; text-align: left; max-height: 350px; overflow-y: auto; padding-right: 15px; border: 1px solid #3a3a3c; background: rgba(0,0,0,0.2); border-radius: 8px; }
        #reviewSection::-webkit-scrollbar { width: 6px; }
        #reviewSection::-webkit-scrollbar-thumb { background: var(--clinic-blue); border-radius: 10px; }

        .review-item { padding: 20px; border-bottom: 1px solid #2c2c2e; }
        .review-q { font-weight: bold; color: #fff; margin-bottom: 8px; font-size: 14px; }
        .correct { color: var(--lab-green); font-weight: bold; }
        .incorrect { color: var(--bio-hazard); text-decoration: line-through; margin-right: 10px; }

        /* Signature Seal */
        .signature-box {
            margin-top: 40px;
            padding: 20px;
            border: 1px dashed var(--clinic-blue);
            display: inline-block;
            text-align: center;
            background: rgba(10, 132, 255, 0.05);
        }
        .sig-font { font-family: 'Brush Script MT', cursive; font-size: 28px; color: var(--sterile-white); }
        .seal-text { font-size: 10px; color: var(--clinic-blue); letter-spacing: 3px; font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>

<div id="startScreen" class="lab-terminal">
    <div class="header"><h2>Incubation Periods & Period of Communicability</h2><span>[IPC-V4.0]</span></div>
    <p style="color: #8e8e93; font-size: 14px; margin-bottom: 20px;">Enter Your Name and Reg No</p>
    <input id="name" class="input-field" placeholder="INPUT FULL NAME...">
    <input id="reg" class="input-field" placeholder="INPUT REGISTRATION ID...">
    <button class="action-btn" onclick="startApp()">START</button>
    <div style="text-align: center; margin-top: 25px; font-size: 10px; opacity: 0.5;">PREPARED BY SIR FRANSISCO</div>
</div>

<div id="quizScreen" class="lab-terminal" style="display:none;">
    <div class="header"><h2 id="qCount">TIME REMAINED</h2><span id="timer" style="color:var(--bio-hazard); font-weight: bold;">600s</span></div>
    <div style="height: 2px; background: #3a3a3c; margin-bottom: 20px;"><div id="progressFill" style="height:100%; width:0%; background:var(--clinic-blue); transition: 0.5s;"></div></div>
    <h3 id="questionText" style="font-weight: 400; font-size: 18px; line-height: 1.6;"></h3>
    <div id="optionsGrid"></div>
    <button class="action-btn" id="submitBtn" onclick="processAnswer()">CHOOSE</button>
    <button class="action-btn" id="nextBtn" onclick="nextQuestion()" style="display:none; background:#fff; color:#000;">CONTINUE â†’</button>
</div>

<div id="resultScreen" class="lab-terminal" style="display:none; text-align:center;">
    <div class="header"><h2>RESULTS</h2></div>
    <div id="studentDetail" style="font-size: 14px; margin-bottom: 10px; color: var(--clinic-blue);"></div>
    <h1 id="scoreDisplay" style="font-size: 60px; margin: 10px 0;"></h1>
    <div id="statusBadge" style="font-weight: bold; font-size: 18px; margin-bottom: 30px;"></div>
    
    <div id="reviewSection">
        <div id="reviewList"></div>
    </div>

  <!-- This is a single-line comment <div class="signature-box">
        <div class="sig-font">Sir Fransisco</div>
        <div class="seal-text">OFFICIALLY CERTIFIED SIGNATURE</div>
    </div>-->

    <button class="action-btn" onclick="location.reload()" style="margin-top:30px; background:transparent; border:1px solid #3a3a3c">RESTART</button>
</div>

<script>
const quiz = [
    // --- CHOLERA (From previous) ---
    {
        q: "What is the incubation period for Cholera according to the IPC protocol?",
        options: ["1-3 days", "2 hours to 5 days", "7-10 days", "2-21 days", "5 years"],
        answer: 1
    },
    {
        q: "What is the period of communicability for a Cholera patient?",
        options: ["During diarrhea and up to 7 days after", "Exactly 14 days", "4 days before and 4 days after rash", "Only 24 hours", "For 5 years"],
        answer: 0
    },

    // --- PERTUSSIS (Whooping Cough) ---
    {
        q: "What is the incubation period for Pertussis (Whooping Cough)?",
        options: ["2-5 days", "10-12 days", "7-10 days", "1-3 days", "2 hours to 5 days"],
        answer: 2
    },
    {
        q: "How long does the period of communicability last for Pertussis?",
        options: ["14 days after treatment", "4 weeks after illness", "2 weeks of treatment", "Until 3 weeks of illness or 5 days of treatment", "Only during the fever"],
        answer: 3
    },

    // --- DIPHTHERIA ---
    {
        q: "According to the Diphtheria module, what is the incubation period?",
        options: ["10-12 days", "2-5 days", "1-3 days", "12-72 hours", "7-10 days"],
        answer: 1
    },
    {
        q: "What is the standard period of communicability for Diphtheria?",
        options: ["4 days after rash", "Usually 14 days of treatment", "Life-long", "6 months", "Only until the fever drops"],
        answer: 1
    },

    // --- MEASLES ---
    {
        q: "When does the high fever typically start in the Measles incubation period?",
        options: ["2-5 days", "1-3 days", "10-12 days", "7-10 days", "2 hours"],
        answer: 2
    },
    {
        q: "What is the period of communicability for Measles?",
        options: ["Until the rash fades", "4 days before and 4 days after onset of rash", "During the period of diarrhea", "14 days after treatment", "Within 2 weeks of treatment"],
        answer: 1
    },

    // --- TUBERCULOSIS (TB) ---
    {
        q: "What is the period of communicability for a drug-susceptible TB case?",
        options: ["Within 2 weeks of treatment", "4 days after rash", "Exactly 7 days", "Only while coughing blood", "Usually for 5 years"],
        answer: 0
    },

    // --- LEPROSY ---
    {
        q: "What is the typical incubation period for Leprosy?",
        options: ["7-10 days", "2-21 days", "5 years (range: 1 to >20 years)", "10-12 days", "12 hours"],
        answer: 2
    },
    {
        q: "When is infectiousness lost in a Leprosy patient?",
        options: ["After 12 months", "Within a day of treatment", "After 5 days", "After 14 days", "It is never lost"],
        answer: 1
    },

    // --- EBOLA DISEASE ---
    {
        q: "What is the incubation period for Ebola Virus Disease?",
        options: ["2-5 days", "1-3 days", "2-21 days", "5 years", "10-12 days"],
        answer: 2
    },
    {
        q: "When does a human become infectious with Ebola?",
        options: ["Immediately after contact", "Only after the rash appears", "Not until they develop symptoms", "During the incubation period", "Only after death"],
        answer: 2
    },

    // --- SHIGELLOSIS ---
    {
        q: "What is the incubation period for Shigellosis?",
        options: ["1-3 days (Range: 12h - 7 days)", "5 years", "10-12 days", "2-5 days", "7-10 days"],
        answer: 0
    },
    {
        q: "How long is the period of communicability for Shigellosis?",
        options: ["7 days", "4 weeks after illness", "Within a day of treatment", "4 days before rash", "Until 3 weeks of illness"],
        answer: 1
    },

    // --- GIARDIASIS ---
    {
        q: "What is the period of communicability for Giardiasis?",
        options: ["7 days", "14 days", "Entire period of infection (often months)", "24 hours", "Only during diarrhea"],
        answer: 2
    },

    // --- AMOEBIASIS ---
    {
        q: "According to the Amoebiasis module, how long may a carrier pass cysts?",
        options: ["For 7 days", "For 14 days", "For years", "For 4 weeks", "Only for 5 days"],
        answer: 2
    }
];
let index=0, score=0, selected=null, timer, timeLeft=600;
let studentName, studentReg;
let studentAnswers = [];

function startApp() {
    studentName = document.getElementById("name").value.trim().toUpperCase();
    studentReg = document.getElementById("reg").value.trim().toUpperCase();
    if(!studentName || !studentReg) return alert("ACCESS DENIED: Credentials Required");
    document.getElementById("startScreen").style.display = "none";
    document.getElementById("quizScreen").style.display = "block";
    startTimer();
    loadQuestion();
}

function startTimer() {
    timer = setInterval(() => {
        timeLeft--;
        document.getElementById("timer").textContent = timeLeft + "s";
        if(timeLeft <= 0) finishQuiz();
    }, 1000);
}

function loadQuestion() {
    selected = null;
    document.getElementById("submitBtn").style.display = "block";
    document.getElementById("nextBtn").style.display = "none";
    const q = quiz[index];
    document.getElementById("qCount").textContent = `QUESTION ${index+1}/${quiz.length}`;
    document.getElementById("questionText").textContent = q.q;
    const grid = document.getElementById("optionsGrid");
    grid.innerHTML = "";
    q.options.forEach((opt, i) => {
        const d = document.createElement("div");
        d.className = "option-card";
        d.innerHTML = `<span style="color:var(--clinic-blue); font-weight:bold; margin-right:10px;">${String.fromCharCode(65+i)}.</span> ${opt}`;
        d.onclick = () => {
            document.querySelectorAll(".option-card").forEach(o => o.classList.remove("active"));
            d.classList.add("active");
            selected = i;
        };
        grid.appendChild(d);
    });
    document.getElementById("progressFill").style.width = ((index / quiz.length) * 100) + "%";
}

function processAnswer() {
    if(selected === null) return;
    const isCorrect = selected === quiz[index].answer;
    if(isCorrect) score++;
    
    studentAnswers.push({
        q: quiz[index].q,
        correct: quiz[index].options[quiz[index].answer],
        student: quiz[index].options[selected],
        isRight: isCorrect
    });

    document.getElementById("submitBtn").style.display = "none";
    document.getElementById("nextBtn").style.display = "block";
}

function nextQuestion() {
    index++;
    if(index < quiz.length) loadQuestion();
    else finishQuiz();
}

function finishQuiz() {
    clearInterval(timer);
    document.getElementById("quizScreen").style.display = "none";
    document.getElementById("resultScreen").style.display = "block";
    
    const pct = Math.round((score/quiz.length)*100);
    const status = pct >= 50 ? "PASS" : "FAIL";
    const timestamp = new Date().toLocaleString(); // Grabs current time

    document.getElementById("scoreDisplay").textContent = pct + "%";
    document.getElementById("studentDetail").textContent = `ID: ${studentReg} | NAME: ${studentName}`;
    
    const badge = document.getElementById("statusBadge");
    badge.textContent = pct >= 50 ? "RESULT: HONGERA" : "RESULT: KIMEKULAMBA-VAA SARE";
    badge.style.color = pct >= 50 ? "var(--lab-green)" : "var(--bio-hazard)";

    // ... (Your existing review list logic remains the same) ...

    // Updated Google Sheets Upload
    const scriptURL = 'https://script.google.com/macros/s/AKfycbztiPdWCeQby9QpBaioJB-sG5eoXx7PsKVimA64IeSpOVW8x2zHQJx0bvMXmwmz4dN4/exec';
    
    // Create the data object to send
    const formData = new FormData();
    formData.append('name', studentName);
    formData.append('reg', studentReg);
    formData.append('marks', score + "/" + quiz.length);
    formData.append('percent', pct + "%");
    formData.append('time', timestamp);
    formData.append('status', status);

    fetch(scriptURL, { 
        method: 'POST', 
        body: formData 
    })
    .then(response => console.log('Success!', response))
    .catch(error => console.error('Error!', error.message));
}
</script>
</body>

</html>

